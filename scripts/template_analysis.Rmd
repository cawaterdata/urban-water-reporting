---
title: "Template Analysis Urban Water Managment"
author: "Erin Cain"
date: "2/1/2022"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)

```

## Template Analysis for Urban Water Managment 

## What Reports are we looking at? 

```{r}
report_1 <- "Urban Water Managment Plan"
report_2 <- "Water Loss Report"
```

## What Metric are we comparing between the reports?

```{r}
metric <- "Volume Water Supplied in Acre Feet"
```

## What data are we using?

Source: 

Tables Names: 
- Report 1: 
- Report 2: 

What agency are we focused on? To pick this we looked across both reports and looked for an agency that participates in both. 

```{r}
agency_of_interest <- "Healdsburg  City Of"
```


Load in data: 
```{r, warning=FALSE, message=FALSE}
data_report_1 <- readxl::read_excel("data-raw/uwmp_table_2_2_r_conv_to_af.xlsx") %>% 
  filter(WATER_SUPPLIER_NAME == "Healdsburg  City Of") %>%
  glimpse()
  
data_report_2 <- readxl::read_excel("data-raw/water_audit_data_conv_to_af.xlsx") %>% 
  filter(REPORTING_YEAR == 2020, WATER_SUPPLIER_NAME == "Healdsburg  City Of") %>% 
  glimpse()

```

### How is our chosen metric described in the report data?

```{r}
volume_supplied_report_1 <- "VOLUME_OF_WATER_SUPPLIED_AF"
volume_supplied_report_2 <- "WS_WATER_SUPPLIED_VOL_AF"
```


```{r}
metric_report_1 <- data_report_1 %>% pull(volume_supplied_report_1)
metric_report_2 <-  data_report_2 %>% pull(volume_supplied_report_2)

delta_water_supplied <- metric_report_1 - metric_report_2
delta_water_supplied_percent <- (metric_report_1 / metric_report_2 - 1) * 100
```

The *difference* in the `r metric` between the `r report_1` and `r report_2` is: `r delta_water_supplied`. 

The *percent difference* is: `r delta_water_supplied_percent` %.


